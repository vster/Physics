% Periodic sequence of triangular pulses

clear
pi1=pi
syms x pi;
digits(3)
alfa=0.5
AM=1
N=15

F1(x)=piecewise(0<=x<2*pi*alfa,AM/(2*pi*alfa)*x,2*pi*alfa<x<=2*pi,0)
% F1(x)=F(x)

fplot(F1(x),[0 2*pi1])
grid on;

A0=1/2*int(F1(x),x,0,2*pi)/pi
% 1/4
vpa(A0)
% 0.25

syms k integer;
assume(k>=1)
A(k)=int(F1(x)*cos(k*x),x,0,2*pi)/pi
% (sin(pi*k)/k - (2*sin((pi*k)/2)^2)/(k^2*pi))/pi
%  =0             =(1-(-1)^k)
A(k)=((-1)^k-1)/(k^2*pi^2)

B(k)=int(F1(x)*sin(k*x),x,0,2*pi)/pi
% (sin(pi*k) - k*pi*cos(pi*k))/(k^2*pi^2)
%  =0               =(-1)^k
B(k)=(-1)^(k+1)/(k*pi)

for k=1:N
    kv(k)=k;
    Av(k)=A(k);
    Bv(k)=B(k);
    Cv(k)=sqrt(Av(k)^2+Bv(k)^2);
    phi(k)=(180/pi1)*atan(Bv(k)/Av(k));
end

Av0=[0;vpa(A0)];
Av0'
% [ 0, 0.25]
ft=[kv;vpa(Av);vpa(Bv);vpa(Cv);vpa(phi)];
ft'
%[  1,   -0.203,   0.318,  0.377, -57.5]
%[  2,        0,  -0.159,  0.159, -90.0]
%[  3,  -0.0225,   0.106,  0.108, -78.0]
%[  4,        0, -0.0796, 0.0796, -90.0]
%[  5, -0.00811,  0.0637, 0.0642, -82.7]
%[  6,        0, -0.0531, 0.0531, -90.0]
%[  7, -0.00414,  0.0455, 0.0457, -84.8]
%[  8,        0, -0.0398, 0.0398, -90.0]
%[  9,  -0.0025,  0.0354, 0.0355, -86.0]
%[ 10,        0, -0.0318, 0.0318, -90.0]
%[ 11, -0.00167,  0.0289,  0.029, -86.7]
%[ 12,        0, -0.0265, 0.0265, -90.0]
%[ 13,  -0.0012,  0.0245, 0.0245, -87.2]
%[ 14,        0, -0.0227, 0.0227, -90.0]
%[ 15, -9.01e-4,  0.0212, 0.0212, -87.6]